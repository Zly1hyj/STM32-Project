# 🐟 基于 STM32 的智能鱼缸控制系统 (Smart Aquarium System)

这是一个基于 STM32F103 单片机的智能鱼缸管理系统，集成了水质监测、自动温控、自动喂食、自动换水及远程物联网控制功能。

## ✨ 主要功能

* **🌡️ 智能温控**：
    * 实时监测水温（DS18B20）。
    * 低温自动开启加热棒 (Relay 3)。
    * 高温自动开启降温风扇 (Relay 4)。
* **💧 水质管理 (TDS)**：
    * 监测 TDS 值，判断水质清洁度。
    * **自动换水逻辑**：当 TDS 超过设定上限时，自动启动排水泵 (Relay 1) 直到低水位，然后启动加水泵 (Relay 2) 直到高水位。
* **🌊 水位监测与保护**：
    * 通过高/低水位传感器监测水位状态。
    * 缺水自动补水，水满自动停止。
* **🍗 自动喂食**：
    * 定时驱动 SG90 舵机进行投食。
    * 喂食期间自动关闭增氧泵，防止饲料飘散。
* **🫧 智能增氧**：
    * 默认开启增氧泵 (Relay 5)。
    * 高温时强制增氧，确保鱼类安全。
* **📱 物联网 (IoT)**：
    * 通过 ESP8266 WiFi 模块连接网络。
    * 每 3 秒上传一次数据（温度、水位状态、TDS）。
    * 支持手机端/上位机远程设置阈值（温度上下限、TDS 上下限等）。
* **🖥️ 交互界面**：
    * 0.96寸 OLED 显示屏实时显示各类参数。
    * 按键调节各类阈值和定时时间。
* **🚨 安全报警**：
    * 声光报警系统（蜂鸣器 + LED 闪烁），当温度、水位或水质异常时触发。

## 🛠️ 硬件清单

* **主控**：STM32F103系列 (推荐 C8T6/RCT6)
* **显示**：0.96寸 OLED 显示屏 (I2C/SPI)
* **传感器**：
    * DS18B20 防水温度传感器
    * TDS 水质检测传感器
    * 非接触式/浮球水位传感器 x2 (高水位/低水位)
* **执行器**：
    * 5路 继电器模块 (控制水泵、加热棒等)
    * SG90 舵机 (喂食器)
    * 有源蜂鸣器
* **通信**：ESP8266 WiFi 模块

## 🔌 引脚连接说明 (Pinout)

| 功能 | 引脚 (Pin) | 描述 |
| :--- | :--- | :--- |
| **指示灯** | PA2 | 运行状态 LED |
| **蜂鸣器** | PA4 | 报警蜂鸣器 |
| **继电器1** | **PA8** | **排水泵 (Drain)** |
| **继电器2** | **PA5** | **加水泵 (Refill)** |
| **继电器3** | PA12 | 加热棒 (Heater) |
| **继电器4** | PA7 | 降温风扇 (Cooler) |
| **继电器5** | PA6 | 增氧泵 (Oxygen) |
| **按键** | PB13 | 设置 (Set) |
| **按键** | PB14 | 切换 (Next) |
| **按键** | PB15 | 翻页 (Page) |
| **按键** | PA11 | 加 (+) |
| **按键** | PB12 | 减 (-) |
| **水位** | **PB8** | 高水位传感器 (High Level) |
| **水位** | **PB9** | 低水位传感器 (Low Level) |
| **舵机** | TIM2 CH4 | 自动喂食器 |
| **通信** | USART | 连接 ESP8266 |
## 📐 硬件原理图
![系统原理图](Doc/Schematic.jpg)

## ⚙️ 阈值默认设置
* **温度**: 上限 35℃ / 下限 15℃
* **TDS**: 上限 90ppm / 下限 30ppm
* **喂食间隔**: 12小时 (43200秒)

---